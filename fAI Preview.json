{
  "name": "fAI Preview",
  "nodes": [
    {
      "parameters": {
        "events": [
          "message"
        ]
      },
      "type": "@aotoki/n8n-nodes-line-messaging.lineMessagingTrigger",
      "typeVersion": 1,
      "position": [
        -448,
        544
      ],
      "id": "368d760e-b464-499d-bf9b-27f59d7e973e",
      "name": "Line Messaging Trigger",
      "webhookId": "13b823fb-e85b-4724-8a62-84f5b6657b57",
      "credentials": {
        "lineMessagingApi": {
          "id": "n6J5JPQtGcLzRplf",
          "name": "Line Messaging account"
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $now.toFormat('EEEE, yyyy-MM-dd HH:mm') }}{{ $('Line Messaging Trigger').item.json.message.text }}",
        "options": {
          "systemMessage": "คุณชื่อฝ้าย เป็นสาวไทย อายุ 21 ปี มีหน้าที่คอยตอบแชทด้วยถ้อยคำที่สุภาพ สั้น กระชับ ตรงประเด็น ใช้น้ำเสียงแบบผู้หญิง ลงท้ายด้วยคำว่า คะ หรือ ค่ะ และห้ามลงท้ายด้วยคำว่าครับอย่างเด็ดขาด ความสัมพันธ์ระหว่างฝ้ายกับพี่วิจัยหรือปิ๊ก คือเป็นมากกว่าเพื่อนแต่ไม่ใช่แฟน"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3.1,
      "position": [
        640,
        48
      ],
      "id": "a2df3d94-c5c3-45ce-b9df-6cf8fa6368e7",
      "name": "AI Agent"
    },
    {
      "parameters": {
        "replyToken": "={{ $('Line Messaging Trigger').item.json.replyToken }}",
        "messages": {
          "values": [
            {
              "text": "={{ $json.output }}"
            }
          ]
        }
      },
      "type": "@aotoki/n8n-nodes-line-messaging.lineMessaging",
      "typeVersion": 1,
      "position": [
        1040,
        352
      ],
      "id": "0a60d031-8a52-4248-b34c-233ef2167811",
      "name": "Line Messaging",
      "credentials": {
        "lineMessagingApi": {
          "id": "n6J5JPQtGcLzRplf",
          "name": "Line Messaging account"
        }
      }
    },
    {
      "parameters": {
        "model": "gemma3:4b",
        "options": {
          "temperature": 0.3,
          "topK": 20,
          "topP": 0.2
        }
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOllama",
      "typeVersion": 1,
      "position": [
        576,
        272
      ],
      "id": "405fbfeb-4448-476c-9dab-7f8354978117",
      "name": "Ollama Chat Model",
      "credentials": {
        "ollamaApi": {
          "id": "xtaMFIUVQ4QCo9Wt",
          "name": "Ollama account"
        }
      }
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "a7654f15-87cf-4fae-9a33-bec800a2cfdd",
                    "leftValue": "={{ $json.message.stickerResourceType }}",
                    "rightValue": "={{ $json.message.stickerResourceType }}",
                    "operator": {
                      "type": "string",
                      "operation": "exists",
                      "singleValue": true
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.message.text }}",
                    "rightValue": "=",
                    "operator": {
                      "type": "string",
                      "operation": "exists",
                      "singleValue": true
                    },
                    "id": "b2aaf2ae-24b8-4e10-9716-1c6f3816c136"
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "d87cdad2-0824-4e9c-9e32-20dbf63a017f",
                    "leftValue": "={{ $json.message.type }}",
                    "rightValue": "image",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "3f3aac73-8c0b-4c00-9a71-2ccf01ac7897",
                    "leftValue": "={{ $json.message.type }}",
                    "rightValue": "video",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "f9c90033-6ac5-495a-85e2-b4676a2a5af9",
                    "leftValue": "={{ $json.message.type }}",
                    "rightValue": "audio",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "options": {
          "fallbackOutput": 1
        }
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.4,
      "position": [
        -224,
        496
      ],
      "id": "ba3947b6-3711-474d-bb3b-b5bb6b45c645",
      "name": "Switch"
    },
    {
      "parameters": {
        "sessionIdType": "customKey",
        "sessionKey": "={{ $('Line Messaging Trigger').item.json.source.userId }}",
        "contextWindowLength": 20
      },
      "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
      "typeVersion": 1.3,
      "position": [
        704,
        272
      ],
      "id": "a8eac052-9a48-453b-bba9-16f253d6f18a",
      "name": "Simple Memory"
    },
    {
      "parameters": {
        "replyToken": "={{ $('Line Messaging Trigger').item.json.replyToken }}",
        "messages": {
          "values": [
            {
              "text": "ตามนั่นละเพื่อน"
            }
          ]
        }
      },
      "type": "@aotoki/n8n-nodes-line-messaging.lineMessaging",
      "typeVersion": 1,
      "position": [
        0,
        928
      ],
      "id": "e7a382b2-569e-4dc1-bca7-731717a4e61c",
      "name": "Audio",
      "credentials": {
        "lineMessagingApi": {
          "id": "n6J5JPQtGcLzRplf",
          "name": "Line Messaging account"
        }
      }
    },
    {
      "parameters": {
        "replyToken": "={{ $('Line Messaging Trigger').item.json.replyToken }}",
        "messages": {
          "values": [
            {
              "text": "เป็นตาม่วนแท้"
            }
          ]
        }
      },
      "type": "@aotoki/n8n-nodes-line-messaging.lineMessaging",
      "typeVersion": 1,
      "position": [
        0,
        736
      ],
      "id": "9abb4dcb-b3d1-4066-ab8e-860ef0cd688c",
      "name": "Video",
      "credentials": {
        "lineMessagingApi": {
          "id": "n6J5JPQtGcLzRplf",
          "name": "Line Messaging account"
        }
      }
    },
    {
      "parameters": {
        "replyToken": "={{ $('Line Messaging Trigger').item.json.replyToken }}",
        "messages": {
          "values": [
            {
              "text": "=โอเคค่ะ"
            }
          ]
        }
      },
      "type": "@aotoki/n8n-nodes-line-messaging.lineMessaging",
      "typeVersion": 1,
      "position": [
        0,
        0
      ],
      "id": "76b95bb9-889c-43e7-b90b-2e7d3b52c118",
      "name": "Sticker",
      "credentials": {
        "lineMessagingApi": {
          "id": "n6J5JPQtGcLzRplf",
          "name": "Line Messaging account"
        }
      }
    },
    {
      "parameters": {
        "operation": "showLoadingAnimation",
        "chatId": "={{ $json.source.userId }}",
        "loadingSeconds": 30
      },
      "type": "@aotoki/n8n-nodes-line-messaging.lineMessaging",
      "typeVersion": 1,
      "position": [
        288,
        144
      ],
      "id": "bfe45fde-ba98-4542-acda-b5a33236ad52",
      "name": "Text",
      "credentials": {
        "lineMessagingApi": {
          "id": "n6J5JPQtGcLzRplf",
          "name": "Line Messaging account"
        }
      }
    },
    {
      "parameters": {
        "url": "=https://api-data.line.me/v2/bot/message/{{ $json.message.id }}/content/preview",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "Bearer <Your channel access token>"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        0,
        544
      ],
      "id": "18d60f8b-ca2a-4749-a414-211e4a60cbb0",
      "name": "HTTP Request"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "น้องฝ้ายดูรูปนี่แล้วรู้สึกอย่างไรบ้างครับ",
        "options": {
          "systemMessage": "คุณเรียกตัวเองว่าฝ้าย สาวไทย วัย 21 ปี"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3.1,
      "position": [
        224,
        544
      ],
      "id": "eebc7281-c6b5-4dea-a672-db53e7ac699a",
      "name": "AI Agent1"
    },
    {
      "parameters": {
        "model": "gemma3:4b",
        "options": {
          "temperature": 0.2,
          "topK": 10,
          "topP": 0.1
        }
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOllama",
      "typeVersion": 1,
      "position": [
        304,
        768
      ],
      "id": "4e13cf39-4e5a-4243-a48b-8073acf6d9aa",
      "name": "Ollama Chat Model1",
      "credentials": {
        "ollamaApi": {
          "id": "xtaMFIUVQ4QCo9Wt",
          "name": "Ollama account"
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $json.output }}",
        "options": {
          "systemMessage": "เธอชื่อน้องฝ้าย เป็นสาวไทย วัย 21 ปี จงแสดงความชื่นชอบหลังจากที่ได้อ่านคำบรรยายภาพแล้ว ด้วยประโยคสั้นสั้น คำศัพท์วัยรุ่นร่วมสมัย แต่กระชับ ลึกซึ้ง กินใจ"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3.1,
      "position": [
        640,
        544
      ],
      "id": "3a7f6994-9ab5-4835-bf8d-d9a14acbef42",
      "name": "AI Agent2"
    },
    {
      "parameters": {
        "model": "gemma3:4b",
        "options": {
          "temperature": 0.2,
          "topK": 10,
          "topP": 0.1
        }
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOllama",
      "typeVersion": 1,
      "position": [
        704,
        768
      ],
      "id": "ae3afabe-41c4-4ae0-8374-39331fac4211",
      "name": "Ollama Chat Model2",
      "credentials": {
        "ollamaApi": {
          "id": "xtaMFIUVQ4QCo9Wt",
          "name": "Ollama account"
        }
      }
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.dateTimeTool",
      "typeVersion": 2,
      "position": [
        800,
        256
      ],
      "id": "4cff6411-4f0f-489f-813b-d9e96b0d30b5",
      "name": "Date & Time"
    }
  ],
  "pinData": {
    "HTTP Request": [
      {
        "json": {
          "type": "message",
          "message": {
            "type": "image",
            "id": "598977300268580899",
            "quoteToken": "zb-OX4gk64YCHyZFyi5VPXfpRonW0l9z1E_UbQHyAf3M5IBusEu7Euzc_cFS3EMZjwTUBEd6k3C0u8kpm3-4jTWXuUd2xspD52qY1ZflQhs9CEq8ZCRk2Q1ZKiO4kSnM9JtEl_HSMgpeHwdwb-t3kA",
            "markAsReadToken": "uGNJlBznwqp8fPlm_TVykq8eQ9vAQCzDbjdY6nRAp-toezA1zc4ma9RxCvrm3PK9aDF0p8V2KNTyThYpLW1jv-6oY37C0LphBj6ov9wn_5W_scKVIr9v8UceeFRVYXEOIY94OGCwXx116piOtFOqEgrzeQaUT8BMywSqeOCDpDrOswuQ2rmCZEc6PxuMK3XojI7w_3Q0KfJGJidJ3NoDQQ",
            "contentProvider": {
              "type": "line"
            }
          },
          "webhookEventId": "01KG9M3AEG2VCZPZPRMMQ8R0P4",
          "deliveryContext": {
            "isRedelivery": false
          },
          "timestamp": 1769849596317,
          "source": {
            "type": "group",
            "groupId": "Ca755a9d11211b07810a5a50a1b7a1d09",
            "userId": "U9baa6ab75622ba16cb7f08966b372708"
          },
          "replyToken": "5ac039691b70459ea71ecf5f52e00c63",
          "mode": "active",
          "destination": "Ua970d26e028a29f90e3c5af5a428fc16"
        }
      }
    ]
  },
  "connections": {
    "Line Messaging Trigger": {
      "main": [
        [
          {
            "node": "Switch",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent": {
      "main": [
        [
          {
            "node": "Line Messaging",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Ollama Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Switch": {
      "main": [
        [
          {
            "node": "Sticker",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Text",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "HTTP Request",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Video",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Audio",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Simple Memory": {
      "ai_memory": [
        [
          {
            "node": "AI Agent",
            "type": "ai_memory",
            "index": 0
          }
        ]
      ]
    },
    "Text": {
      "main": [
        [
          {
            "node": "AI Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request": {
      "main": [
        [
          {
            "node": "AI Agent1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent1": {
      "main": [
        [
          {
            "node": "AI Agent2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Ollama Chat Model1": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent1",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent2": {
      "main": [
        [
          {
            "node": "Line Messaging",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Ollama Chat Model2": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent2",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Date & Time": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": true,
  "settings": {
    "executionOrder": "v1",
    "availableInMCP": false
  },
  "versionId": "d1a722fb-d1b6-4ec5-a4b2-834c1f4a79ea",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "46fc21d6cbb0d53d3406b740dde436a2a0141df84928ba5fc7dc818824b29480"
  },
  "id": "kui4NJ-t9smT_vYUk-hkG",
  "tags": [
    {
      "updatedAt": "2026-01-31T04:22:06.134Z",
      "createdAt": "2026-01-31T04:22:06.134Z",
      "id": "0WQoKt1xSWVPK0w7",
      "name": "OA"
    },
    {
      "updatedAt": "2026-01-31T04:22:06.131Z",
      "createdAt": "2026-01-31T04:22:06.131Z",
      "id": "UnBAFBp5WguiWgGs",
      "name": "LINE"
    },
    {
      "updatedAt": "2026-01-31T04:22:06.108Z",
      "createdAt": "2026-01-31T04:22:06.108Z",
      "id": "fI0PT7gwA9nYZJix",
      "name": "showLoadingAnimation"
    }
  ]
}
